<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>top</title>
    <style>
        *{
            /* pointer-events: none; */
            /* background:none; */
            background: transparent;
        }
        body 
        {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background: none;
            padding: 1px;
            display: flex;
            place-content: center;
            flex-direction: row;
            width: 100%;
            height: 100%;
        }
        #barID 
        {
            max-height: 100px;
            min-height: 22px;
            display: flex;
            width: 96%;
            height: 32px;
            background: rgba(5, 5, 5, 0.35);
            /* background-color: #ffffffba; */
            position: absolute;
            /* cursor: ns-resize; */
            align-items: center;
            border-radius: 18px;
            padding-inline: 1%;
            /* margin-inline: 1%; */
            user-select: none;
            backdrop-filter: blur(2px);
            margin: auto;
            bottom: 75px;
            margin-right:1px;
           /*  left: 0px; */
        }   
        #iconTask
        {
            height:auto;
            width:22px;
            margin-left: 6px;
        }
       .taskbutton{
            margin-inline-end: 5px;
            height: 50%;
            aspect-ratio: 1/1;
            background: #00000021;
            border-radius: 100%;
            padding: 3px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .taskbutton:hover
        {
            background: #00000037;
        }  
        #barResizeID
        {
            background: rgba(0, 0, 0, 0.01);
            display: flex;
            width: 96%;
            height: 40px;
            position: absolute;
            /* cursor: ns-resize; */
            align-items: center;
            bottom: 75px;
            border-radius: 18px;
            overflow: hidden;
            padding-inline: 1%;
            /* margin-inline: 1%; */
            cursor:n-resize;
            margin:0px;
        }
        #barClockID
        {
            display: flex;
            height: 40%;
            border-radius: 24px;
            padding: 4px;
            padding-inline: 10px;
            font-size: 14px;
        /*    font-size: 12px;
            font-family: system-ui; */
            align-items: center;
        }
        .contextMenu
        {
            display: none;
            position: absolute;
            /* width: 134px; */
            /* height: 271px; */
            background-color: rgb(228, 228, 228);
            opacity: 0.8;
            border: none;
            border-radius: 10px;
            overflow: hidden;
            z-index: 222;
            /* text-align: center; */
            left: 116px;
            top: 50px;
        }
        .contextMenu tr td
        {
            border-radius: 10px;
            /* text-align: center; */
            text-wrap: nowrap;
            padding: 8px;
        }
        .contextMenu tr td:hover
        {
            background:rgb(124, 124, 124);
            text-align: center;
        }
        .icons
        {
            display: flex;
            background: #fffefe;
            padding: 6px;
        }
        .contextMenu tr th img:hover
        {
            border-radius: 100%;
            background:rgb(236, 236, 236);
        }
        .contextMenu tr th img
        {
            padding:5px;
        }
        .hide
        {
            display: none!important;
            opacity: 0;
            transition: cubic-bezier(0.4, 0, 1, 1) 0.3s;
        }
        .unHideSlowly{
            transition: ease-in 5s;
        }
        #searchOverlayID{
            display: flex;
            width: 100%;
            height: 100%;
            background: #0000008f;
            position: absolute;
            backdrop-filter: blur(1px);
            text-align: center;
            z-index: 99999;
            flex-direction: column;
            align-items: center;
        }
        #searchOverlayID input{
            border-radius: 55px;
            width: 100%;
            height: 35px;
            background: rgb(255 255 255);
            border-style: none;
            outline: none;
            padding-inline: 15px;
            box-shadow: 0px 0px 8px 2px #cbcbcb99;
        }
        #searchBarID{
            margin: auto;
            width: 30%;
            height: auto;
            top: 20%;
            left: auto;
            position: absolute;
        }
        .darkMode{
            filter:invert();
        }
        .darkModeText{
            color:white;
        }
        /* Settings panel START */
        .xInputs {
            margin: 0px;
            padding: 0px;
            left: 6%;
            z-index: 9000;
            position: absolute;
            display: none;
            background: rgb(0 0 0 / 86%);
            flex-direction: column;
            border-radius: 12px;
            contain: content;
        }
        .inputAddButtonId{
            display: flex;
            padding: 10px;
            flex-direction: row;
        }
        .inputAddButtonId input[type=button]{
            width: 42px;
            height: 23px;
            margin: 2px;
            border-radius: 24px;
            /* font-size: larger; */
            border: none;
            margin-top: 12px;
            color: #292929;
        }
        .inputAddButtonId input[type=button]:hover{
            opacity: 80%;
        }
        .inputAddButtonId input[type=button]:active{
            opacity: 50%;
        }
        .settingsRow{
            margin-top:10px
        }
        .appThumb{
            top: -200px;
            display: flex;
            position: absolute;
            background: rgba(41, 41, 41, 0.33);
            height:200px;
            width: auto;
            min-width: 290px;
            border-radius: 14px;
            opacity: 1;
            padding:5px;
/*             left:100px;
            bottom:100px; */
        }
        .appThumb img{
            margin: auto;
            height: 50px;
            width: 50px;
            background: rgba(255, 255, 255, 0.599);
            z-index: 9999;
            border-radius: 11px;
        }
        .appThumb img:hover{
            background: rgba(128, 128, 128, 0.707);
            /* scale:1.3; */
        }
        #trayIconsID{
            display: flex;
            height: 40%;
            width: auto;
            margin-right: 5px;
            border-radius: 24px;
            padding: 4px;
            padding-inline: 10px;
            font-size: 14px;
            align-items: center;
        }
            .appTrayContainer{
            display: flex;
            width: 100%;
            height: 10%;
            background:rgb(113 113 113 / 58%);
            border-radius: 0px 0px 10px 10px;
            margin-top: 37px;
        }
        .appTray{
            background:rgb(113, 113, 113);
            width: 90%;
            height: 70%;
            border-radius: 10px;
            margin:auto;
        }
        #appMenuContainerID{
            background: rgb(0 0 0 / 64%);
            width: 472px;
            height: 420px;
            border-radius: 14px;
            position: absolute;
            top: 361px;
            left: 421px;
            contain: content;
            display: flex;
            flex-direction: column;
            cursor: auto;
            user-select: none;
            border: 4px solid #96969680;
        }
        #appMenuID{
            display: flex;
            height: 100%;
            width: 100%;
            flex-wrap: wrap;
            position: relative;
            flex-direction: row;
            /* align-content: center; */
            gap: 14px;
            overflow: hidden;
            justify-content: flex-start;
            padding: 13px;
        }
        .appMenuIconContainer{
            contain: content;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 2px;
            height: 82px;
            width: 62px;
            padding: 5px;
            text-align: center;
            text-shadow: 1px 1px 6px #606060ab;
            user-select: none;
        }
        .appMenuIconContainer:hover{
            background: #5b5b5b;
            border-radius: 14px;
            /* contain: inline-size; */
            /* height: auto; */
        }
        #appMenuShortcutsID{
            height: 100%;
            width: 100%;
            height: 44px;
            /* background: #a9a9a97a; */
            position: relative;
            display: flex;
            color: white;
            flex-direction: row;
            flex-wrap: nowrap;
            justify-content: flex-start;
            align-items: center;
            gap: 6px;
            padding: 6px;
        }
        #appMenuShortcutsID div{
            opacity: 0.2;
        }
        #appMenuShortcutsID div:hover{
            opacity: 0.4;
        }
        .appMenuIcon{
            width: 48px;
            height: 48px;
        }
        #appMenuPages{
            color: white;
            height: 100%;
            width: 100%;
            height: 32px;
            /* background: #a9a9a97a; */
            position: relative;
            display: flex;
            align-content: center;
            align-items: center;
            justify-content: center;
        }
        .active{
            opacity: 1 !important;
        }
        .colorBackground{

        }
        .colorDarker{
         background:black;   
        }
        .color{
            background:rgba(176,176,176,0.60);
        }
    </style>

    
       <style>
        body{
           /*  width: 100%; */

         /*    width: 648px;
            max-width: 100%;
            display: flex;
            flex-wrap: nowrap;
            margin: 0px; */

            /* padding: 4px; */
        }
        .sliderContainer{
            text-align: center;
        }
        .slider {
        -webkit-appearance: none;
        width: 100%;
        height: 20px;
        background: #d3d3d3;
        outline: none;
        -webkit-transition: .2s;
        transition: opacity .2s;
        margin: 10px;
        border-radius: 10px;
        }
        .slider:hover {
        opacity: 1;
        }
         .sliderTrack{
        -webkit-appearance: none;
        appearance: none;
        width: 15px;
        height: 15px;
        background: rgb(248 125 166 / 44%);;
        cursor: pointer;
        position: absolute;
        border-radius: 10px;
        margin: 13px;
        z-index: 0;
        pointer-events: none;
        min-width: 10px;
         }
        .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 15px;
        height: 15px;
        background: #ff80db00;
        cursor: pointer;
        border-radius: 100%;
        z-index:999;
        }
    
        .slider::-moz-range-thumb {
        width: 15px;
        height: 15px;
        background: #ff80db;
        cursor: pointer;
        z-index:999;
        }
        .hide{
            display: none !important;
        }
        #windowContainerID{
            position: absolute;
            width: 647px;
            height: 552px;
            margin: 0px;
        }
        .windowContent{
            display: flex;
            width: 100%;
            height: 100%;
            background: #c6c6c663;
            border-radius: 14px;
            /* backdrop-filter: blur(11px); */
            box-shadow: 0px 0px 20px 6px #00000038;
            z-index: 999;
            flex-direction: row;
            /* padding: 7px; */
            justify-content: flex-start;
            min-width: 472px;
            margin: 10px;
            position: absolute;
        }
        /* .WindowBar{
            background-color: #f0f0f099;
            height: 32px;
            width: 100%;
        }
        .WindowContentInside{
            width: 100%;
            height: 100%;
            background:white;
        } */
        .buttonsHolder{
            right: 0px;
            top: 5px;
            position: absolute;
            background: #27272745;
            width: 81px;
            height: 13px;
            margin-inline-end: 5px;
            border-radius: 18px;
            padding: 5px;
            padding-top: 4px;
        }
        .windowMainButtons{
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
            align-content: center;
            align-items: center;
            text-align: center;
        }
        .windowTabTitleButton{
            display: flex;
            width: auto;
            flex-wrap: nowrap;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            color: white;
            -webkit-text-stroke-color: #dadada;
            max-width: 170px;
        }
        .windowTabTitleText{
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
            margin: auto;
            position: absolute;
        }
        .windowButton{
            margin-inline-end: 5px;
            width: 4px;
            height: 4px;
            aspect-ratio: 1/1;
            border-radius: 100%;
            padding: 5px;
            display: block;
            align-items: center;
            justify-content: center;
            /* position: absolute;*/
        }
        .windowButton:hover{
            scale:1.2;
        }
        #detailsID{
            width: auto;
        }
        #resizersBoxID{
            position: absolute;
            display: flex;
            width: calc(100% + 20px);
            height: calc(100% + 26px);
        }
        .resizer-horizontal{
            position: absolute;
            width: 30px;
            height: calc(100% - 80px);
            right: 0px;
            top: 40px;
        }
        .resizer-vertical{
            position: absolute;
            width: calc(100% - 100px);
            height: 30px;
            left: 50px;
            transition: cursor 2s;
        }
        .resizer-corner{
            position: absolute;
            width: 30px;
            height: 30px;
            transition: cursor 2s;
        }
</style>

</head>
<body>
<!--    ---------Context menu START(change to tag menu in future)------------------ -->
    <div class="contextMenu" id="contextMenuID">
        <table style="width: 100%;display: flex;">
            <tbody style="width: 100%;display: flex;flex-direction: row;align-items: center;">
                <tr onclick="">
                    <th style="display: flex;flex-direction: column;">
                        <div class="icons" style="display: flex;">
                            <img alt="Copy" src="/icons/copy.png" style="height: 24px;">
                        </div>
                        <div class="icons" style="display: flex;">
                            <img alt="Cut" src="/icons/cut.png" style="height: 24px;margin: auto;"></div>
                        <div class="icons" style="display: flex;">
                            <img alt="Paste" src="/icons/paste.png" style="height: 24px;"></div>
                        <div class="icons" style="display: flex;" onmouseenter="console.log('hell');">
                            <img alt="Respawn" src="/icons/reload.png" style="height: 24px;" ></div>
                        <div class="icons" style="display: flex;">
                            <img alt="Settings" src="/icons/settings.png" style="height: 24px;">
                        </div><div class="icons" style="display: flex;">
                            <img  alt="New" src="/icons/add.png" style="height: 24px;">
                        </div>
                    </th>
                </tr>
            </tbody>
        </table>
    </div>
<!--    ---------Context menu END(change to tag menu in future)------------------ -->
<!--    ---------Webviews START(change to tag and inject it in future)------------------ -->
<webview id="transferDialogID" onmouseleave="" class="hide" allowtransparency allownw style="position: absolute;z-index: 10000;width: 1050px;height: 477px;bottom: 178;display: block;background: transparent;" partition="trusted" src="/transferDialog/transferDialog.html" type=""></webview>
<webview id="appMenuID" onmouseenter="" onmouseleave="" class="hide" alwaysontop allowtransparency allownw style="position: absolute;z-index: 10000;width: 711px;height: 877px;left:600px;bottom:94px;display: block;" partition="trusted" src="/appMenu/appMenu.html" type=""></webview>
<webview id="mediaCenterID" onmouseenter="mouseLeftObject.mediaCenter=false" onmouseleave="" class="hide" alwaysontop allowtransparency allownw style="position: absolute;z-index: 10000;width: 311px;height: 177px;left:600px;bottom:94px;display: block;" partition="trusted" src="/volumeControl/mediaCenter.html" type=""></webview>
<webview id="calendarID" onmouseenter="mouseLeftObject.calendar=false" onmouseleave="mouseLeftObject.calendar=true" class="hide" allowtransparency allownw style="position: absolute;z-index: 10000;width: 311px;height: 460px;left:1200px;bottom:94px;display: block;" partition="trusted" src="/calendar/calendar.html" type=""></webview>
<webview id="controlCenterID" onmouseenter="mouseLeftObject.controlCenter=false" onmouseleave="mouseLeftObject.controlCenter=true"  class="hide" allowtransparency allownw style="position: absolute;z-index: 10000;width: 350px;height: 410px;bottom: 75px;display: block;" partition="trusted" src="/controlCenter/controlCenter.html" type=""></webview>
<webview id="sideBarID" onmouseenter="mouseLeftObject.sideBar=false" onmouseleave="mouseLeftObject.sideBar=true" class="hide" allowtransparency style="position: absolute;z-index: 10000;display: block;height: 427px;width:420px;height: calc(100% - 200px);right:2px;top:100px;background: transparent;" partition="trusted" src="/edgy/edgy.html" type=""></webview>
<!--    ---------Webviews END(change to tag and inject it in future)------------------ -->
<!--    ---------Bar START(add options to change orientation in future)------------------ -->
<div id="barResizeID"></div>
<div id="barID" class="colorBackground">
    <div id="trayIconsID" class="color darkMode"></div>
    <img class='taskbutton color darkMode' src="/icons/toggle.png" oncontextmenu="openSettings()" onclick="openControlCenter(event);"></img>
    <img class="taskbutton color darkMode" src="/icons/sidebar.png" onclick="openSideBar()">
    <img class="taskbutton color darkMode" src="/icons/search.png" onclick="openSearch();">
    <div id="barAppsID" style="display: flex;align-items: center;margin:auto;height: 100%;">
        <div class='taskbutton color darkMode' onmouseleave="" onclick="openAppMenu()"><img src="/icons/apps.png" class="darkMode" onclick='' style='height:100%;width:100%'></div>
        <img class="taskbutton color darkMode" src="/icons/repeat.png" onclick="exec('kioclient5 exec /usr/share/applications/firefox.desktop');getBarIconsBasedOnList()">
        <img id='iconTest'src="">
    </div>
    <div id="barClockID" class="color darkMode" onclick="openCalendar(event)" style=""></div>
</div>
<!--    ---------Bar END(add options to change orientation in future)------------------ -->
<!--    -----------------------Tray START--------------------------------------------- --> 
<div class="appTrayContainer colorDarker">
    <div class="appTray color"> </div>
</div>
<!--    -----------------------Tray END--------------------------------------------- --> 
<!--    -----------------------Settings START--------------------------------------------- --> 
<div class="xInputs" id="settingsContainerId" style="display: none; top: 30%; left: 45%; color: white; font: -webkit-control;">
    <div class="inputAddButtonId" style="flex-direction: column;padding: 14px;margin-inline: 5px;">
     <div class="settingsRow" style="align-self: auto;font: -webkit-control;margin-bottom: 15px;font-size: medium;">Settings:</div> 
     <div class="settingsRow" style="align-self: flex-end;">
        <span>Panels color: 
            <input type="color" name="" id="barColorId" oninput="resizableBar.style.background=this.value+'33';"> </span>
        </div>
     <div class="settingsRow" style="align-self: flex-end;">
        <span>Accent color: 
            <input type="color" name="" id="buttonsColorId" oninput="acentColorChange(this.value)"> 
        </span></div>
     <div class="settingsRow" style="align-self: flex-end;">
        <span>Shadows: 
            <input type="color" name="" id="barColorId" oninput="resizableBar.style.boxShadow='0px 0px 4px 1px'+ this.value+'66';"> 
        </span>
    </div>
     <input type="button" style="width:150px;background:rgb(255, 255, 255);margin-top: 20px;
     align-self: center;" value="Disable shadows" onclick="resizableBar.style.boxShadow=''">
     <div class="settingsRow" style="margin-top: 15px;align-self: center;">
        <span>Bar transparency: 
     </span>
    </div>
     <div class="settingsRow" style="align-self: center;">
        <span>
            <input type="range" min="0" max="0.99" step="0.01" name="" id="barTransparencyId" oninput="var color=resizableBar.style.background;var colorSliced=color.slice(0, color.lastIndexOf(','));resizableBar.style.background=colorSliced+','+this.value+')'"> 
        </span>
    </div>
     <div class="settingsRow" style="margin-top: 15px;align-self: center;">
        <span>Bar width: 
        </span>
    </div>
     <div class="settingsRow" style="align-self: center;">
        <span>
            <input type="range" min="30" max="98" step="1" name="" id="barWidthId" oninput="if(this.value<35){resizableBar.style.width='auto'}else{resizableBar.style.width=this.value+'%'}"> 
        </span>
    </div>
     <div class="settingsRow" style="margin-top: 15px;align-self: center;">
        <span>Bar border radius: 
        </span>
    </div>
     <div class="settingsRow" style="align-self: center;">
        <span>
            <input type="range" min="0" max="30" step="1" name="" id="barBorderRadiusId" oninput="resizableBar.style.borderRadius=this.value+'px'"> 
        </span>
    </div>
     <input type="button" style="width:82px;background:rgb(255, 255, 255);margin-top: 20px;
     align-self: center;" value="close" onclick="this.parentElement.parentElement.style.display='none';">
    </div>
  </div>
<!--    -----------------------Settings END--------------------------------------------- --> 
<!--    -----------------------Search START--------------------------------------------- --> 
<div id="searchOverlayID" class="searchOverlay hide" onclick="openSearch();">
    <div id="searchBarID"><input type="text" name="" id="searchOverlayInputID" placeholder="Search or run program"></div>
</div>  
<!--    -----------------------Search END--------------------------------------------- --> 
<!--    -----------------------Window TEST START--------------------------------------------- --> 
<div id="windowContainerID" class="opaque">
    <div id="resizersBoxID">
        <div class="resizer-corner" id="resizerTopLeftID" style="left: 0px;top: 0px;cursor: nw-resize;" onmousedown="resizeWindow(event)"></div>
        <div class="resizer-vertical" id="resizerTopID"  style="top: 0px;cursor: n-resize;" onmousedown="resizeWindow(event)"></div>       
        <div class="resizer-vertical" id="resizerBottomID" style="bottom: 4px;cursor: s-resize;" onmousedown="resizeWindow(event)"></div>
        <div class="resizer-corner" id="resizerTopRightID" style="right: 0px;top: 0px;cursor: ne-resize;" onmousedown="resizeWindow(event)"></div>
        <div class="resizer-horizontal" id="resizerRightID" style="right: 0px;cursor: e-resize;" onmousedown="resizeWindow(event)"></div>
        <div class="resizer-horizontal" id="resizerLeftID" style="left: 0px;cursor: w-resize;" onmousedown="resizeWindow(event)"></div>
        <div class="resizer-corner" id="resizerBottomLeftID" style="left: 0px;bottom: 4px;cursor: sw-resize;" onmousedown="resizeWindow(event)"></div>
        <div class="resizer-corner" id="resizerBottomRightID" style="right: 0px;bottom: 4px;cursor: se-resize;"  onmousedown="resizeWindow(event)"></div>
    </div>
    
    <div class="windowContent" id="windowContentID" onmousedown="resizeWindow(event)" style="">
        <div class="WindowBar">
    
        <div class="buttonsHolder windowTabTitleButton" onclick="" style="left: 10px;">
            <div class="windowTabTitleText" style="">This is Title</div>
        </div>
    
        <div class="buttonsHolder windowTabTitleButton" onclick="" style="left: 196px;">
            <div class="windowTabTitleText" style="">This is Title 2</div>
        </div>
    
        <div class="buttonsHolder windowMainButtons" onclick="" style="">
            <div class="windowButton" onclick="" style="margin: auto;background: #c3c3c3;"></div>
            <div class="windowButton" onclick="" style="margin: auto;background: #fff49b;"></div>
            <div class="windowButton" onclick="" style="margin: auto;background: #cbff9b;"></div>
            <div class="windowButton" onclick="" style="margin: auto;background: #ff9b9b;"></div>  
        </div>
        </div>
    </div>
    </div>
            <script>
               console.log("checkpoint 1");
               let orgWidth=0;
               let orgHeight=0;
               let mousePosX=0;
               let mousePosY=0;
               let orgTop=0;
               let orgLeft=0;
               let source="";
               let theWindow=document.getElementById("windowContainerID");
               console.log("checkpoint 2");
               function resizeWindow(event){
                source=event.srcElement.id;
                event.preventDefault();
                orgWidth=theWindow.offsetWidth;
                orgHeight=theWindow.offsetHeight;
                orgTop=theWindow.offsetTop;
                orgLeft=theWindow.offsetLeft;
                document.addEventListener('mousemove', resize);
                document.addEventListener('mouseup', stopResize);
                mousePosX=event.clientX;
                mousePosY=event.clientY;
                console.log(event);
               }
               function resize(e){
                    const width = orgWidth+ (e.pageX - mousePosX);
                    const height=orgHeight+ (e.pageY - mousePosY);
                    if(source=="resizerBottomRightID"){
                        theWindow.style.width = width + 'px';
                        theWindow.style.height = height + 'px';
                        }
                    if(source=="resizerTopRightID"){
                        theWindow.style.top=orgTop+(e.pageY - mousePosY)+'px';
                        theWindow.style.width = orgWidth+(e.pageX - mousePosX) + 'px';
                        theWindow.style.height = orgHeight-(e.pageY - mousePosY) + 'px';
                    }
                    if(source=="resizerBottomLeftID"){
                        theWindow.style.width = orgWidth-(e.pageX - mousePosX) + 'px';;
                        theWindow.style.height = height + 'px';
                        theWindow.style.left=orgLeft+(e.pageX - mousePosX)+'px';
                    }
                    if(source=="resizerTopLeftID"){
                        theWindow.style.top=orgTop+(e.pageY - mousePosY)+'px';
                        theWindow.style.left=orgLeft+(e.pageX - mousePosX)+'px';
                        theWindow.style.width = orgWidth-(e.pageX - mousePosX) + 'px';
                        theWindow.style.height = orgHeight-(e.pageY - mousePosY) + 'px';
                        console.log(theWindow.style.offsetRight);
                    }
                    if(source=="resizerTopID"){
                        theWindow.style.top=orgTop+(e.pageY - mousePosY)+'px';
                        theWindow.style.height = orgHeight-(e.pageY - mousePosY) + 'px';
                    }
                    if(source=="resizerBottomID"){
                        theWindow.style.height = height + 'px';
                    }
                    if(source=="resizerLeftID"){
                        theWindow.style.width = orgWidth-(e.pageX - mousePosX) + 'px';;
                        theWindow.style.left=orgLeft+(e.pageX - mousePosX)+'px';
                    }
                    if(source=="resizerRightID"){
                        theWindow.style.width = orgWidth+(e.pageX - mousePosX) + 'px';
                    }
                    if(source=="windowContentID"){
                        theWindow.style.top=orgTop+(e.pageY - mousePosY)+'px';
                        theWindow.style.left=orgLeft+(e.pageX - mousePosX)+'px';
                    }
                }
                console.log("checkpoint 3");
                function stopResize() {
                document.removeEventListener('mousemove', resize)
                }
                console.log("checkpoint 4");
            </script>
<!--    -----------------------Window TEST END--------------------------------------------- --> 



<!--    -----------------------Functions Microsoft Linux START--------------------------------------------- --> 

<script>
// Require
    const os = require('node:os'); //To get OS info
    const { exec } = require('child_process');
/*     const { listOpenWindows } = require('@josephuspaye/list-open-windows'); */
    // On extract assign icons
  /*   iconExtractor.emitter.on('icon', function(data)
            {
                RunningProcessList[num].Icon="data:image/png;base64,"+data.Base64ImageData+"";
                refreshBarIcons();                            
            }); */
    // Get the list of open windows
    console.log("checkpoint 5");
     //RunningProcessList.forEach(console.log);
     // Delaying getting icons in bar, cause it needs time
    // function getBarIconsBasedOnList()
    // {
    //     var len=RunningProcessList.length;
    //     var time=300;
    //     if(num<len)
    //     {
    //         for(let i=0;i<len;i++)
    //         {
    //             setTimeout(() => 
    //             {
    //             console.log("Delayed for 100 ms.");
    //             getBarIcon(i);
    //             }, time);
    //             time=time+100;
    //         }
    //     }
    // }
    console.log("checkpoint 6");
//////////////////////////////////////// Fetch icons for bar icons
    function getBarIcon(numB){ 
            num=numB;
            /* iconExtractor.getIcon("",RunningProcessList[num].processPath.replace(/\\/g, '/'));        */    
        }
 ////////////////////////////////////////
 ////////////////////////////////////////  Maximize/minimize apps based on process id
 function showORhideAPP(processId){
            console.log("Trying to show: "+processId);
            /* showORhideShell.invokeCommand("C:/Users/X.000000000000000000/procesessB.ps1 -Style 'SHOWDEFAULT' -processID "+processId+""); */
        }
//////////////////////////////////////// Push new app into process list and into bar
        function pushNewApp(){
            
        }
        //////////////////////////////////////// Volume control functions
        function volumeMute(){
            /* volume.invokeCommand('[audio]::Volume='+0.00+';'); */
        }
        function volumeUp(){
            /* volume.invokeCommand('[audio]::Volume=[audio]::Volume+'+0.01+';'); */
        }
        function volumeDown(){
            /* volume.invokeCommand('[audio]::Volume=[audio]::Volume-'+0.01+';'); */
        }
        console.log("checkpoint 7");
</script>
<!--    -----------------------Functions Microsoft Linux END--------------------------------------------- --> 


<script>
         const LAUNCHER_TYPE='nw'
         console.log("width="+window.innerWidth);
         /* let AppProcessID=nw.process.ppid; */ //App process ID, use window.process.ppid instead
         let barElement=document.getElementById('barAppsID');
         var colorMain="background-color: #353535ba;";
        if(LAUNCHER_TYPE=='nw'){
         var win=nw.Window.get();
         //win.setAlwaysOnTop(true);
        }
        console.log("checkpoint 8");
         var num=0;
//////////////////////////////////////// Refresh icons in bar  
        var pinnedPaths=['C://Windows//explorer.exe'];
        barRunningApps+=pinnedPaths[0];
        var pinnedAppsList=[`<div id="explorer" class="taskbutton color darkMode" title="top" onmouseover="showAppThumb(this,event);" onmouseleave="this.children[0].classList.add('hide')"><div class="appThumb hide darkMode" onmouseenter="mouseEnterObject.thumbnail=true" onmouseleave="hideAppThumb(0);"><img id="44608" src="/icons/explorer.png" onclick="openItem('C://Windows//explorer.exe')"></div><img id="44608" src="/icons/explorer.png" class="darkMode" onclick="openItem('C://Windows//explorer.exe')" style="height:100%;width:100%"></div>`]
        var pinnedApps
        pinnedApps=pinnedAppsList.join();
        var barRunningApps=[];
        console.log("checkpoint 9");
        function dewIt()
        {
        RunningProcessList.forEach(element=>{
            barElement.innerHTML="";
            if(barRunningApps.includes(element.processPath)){
                var indexOfProcess=barRunningApps.indexOf(element.processPath);
                console.log("double window"+element.processPath);
                console.log(barElement.children[indexOfProcess]);
            }
            else{
            barRunningApps.push(element.processPath);
            console.log(element.icon);
            barElement.innerHTML=barElement.innerHTML+`<div id='`+element.processPath+`'><img class="taskbutton color" id='`+element.processId+`' src="`+element.Icon+`" title="`+element.caption+`" onclick='showORhideAPP(`+element.processId+`)'></div>`;
            }
        });
        }
        console.log("checkpoint 10");
        function refreshBarIcons(){
            barRunningApps=[];
            barElement.innerHTML="";
            RunningProcessList.forEach(element=>{
            if (element.Icon==undefined){
                element.Icon='/icons/testWindow.png'
            }
            if(barRunningApps.includes(element.processPath)){
                var indexOfProcess=barRunningApps.indexOf(element.processPath);
        /*         console.log("double window"+element.processPath);
                console.log("child");
                console.log(barElement.children[indexOfProcess]); */
                barElement.children[indexOfProcess].children[0].innerHTML+=`<img id='`+element.processId+`' src="`+element.Icon+`" onclick='showORhideAPP(`+element.processId+`)'>`;
                barElement.children[indexOfProcess].children[1].outerHTML=`<img id='`+element.processId+`' class="darkMode" src="`+element.Icon+`" onmouseover="showAppThumb(this.parentElement,event);" style="height:100%;width:100%">`
            }
            else{
            barRunningApps.push(element.processPath);
            var index=barRunningApps.length-1;
            console.log(element.icon);
            barElement.innerHTML=barElement.innerHTML+`<div id='`+element.processPath+`' class='taskbutton color darkMode' title="`+element.caption+`" onmouseover="showAppThumb(this,event)" onmouseleave="this.children[0].classList.add('hide')"><div class="appThumb hide darkMode" onmouseenter="mouseEnterObject.thumbnail=true" onmouseleave="hideAppThumb(`+index+`);">s</div><img id='`+element.processId+`' src="`+element.Icon+`" class="darkMode" onclick='showORhideAPP(`+element.processId+`)' style='height:100%;width:100%'></div>`;
            barElement.children[index].children[0].innerHTML+=`<img id='`+element.processId+`'  src="`+element.Icon+`" onclick='showORhideAPP(`+element.processId+`)'>`;
            }
        });
        barElement.innerHTML=pinnedApps+barElement.innerHTML;
        }
        console.log("checkpoint 11");
////////////////////////////////////////  
        function hideAppThumb(index){
            if(mouseEnterObject.thumbnail==false){
            barElement.children[index].children[0].classList.add('hide');
        }
        }
////////////////////////////////////////  
        function showAppThumb(element,event){
            var index=Array.prototype.findIndex.call(barElement.children, (c) => c === element);
            console.log("showAppThumb:"+index)
/*             console.log(event);
            console.log("Position left:"+ parseInt(event.clientX+200)+"px")
            barElement.children[index].children[0].style.left=parseInt(event.clientX+200)+"px";
            barElement.children[index].children[0].style.top=parseInt(event.clientY+200)+"px"; */
            barElement.children[index].children[0].classList.remove('hide');
        }
        console.log("checkpoint 12");
//////////////////////////////////////// Bar clock function
        let monthsList=["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        function startTime() {
            const today = new Date();
            let month=today.getMonth();
            let date=today.getDate();
            let h = today.getHours();
            let m = today.getMinutes();
            m = checkTime(m);
            document.getElementById('barClockID').innerHTML =  date+" "+monthsList[month]+" "+ h + ":" + m ;
            setTimeout(startTime, 60000);
            }
//////////////////////////////////////// Bar clock function
        function checkTime(i) {
            if (i < 10) {i = "0" + i};  // add zero in front of numbers < 10
            return i;
            }
            console.log("checkpoint 13");
////////////////////////////////////////
        /* win.resizeTo(1920,1080); */ //Only if its FHD res screen, in final it should be fullscreen always
        /*  win.enterKioskMode(); */

        /* win.showDevTools(); */ //Won't work without NW.JS SDK downloaded seperatly and putting it in node_modules/nw
        startTime(); //turn on the clock in bar
////////////////////////////////////////
var mouseLeftObject={};
var mouseLeftObject={calendar:true,controlCenter:true,runningAppsThumbnail:true,bar:true,mediaCenter:true,sideBar:true};
var mouseEnterObject={thumbnail:false};
var resizableBar = document.getElementById('barID');
console.log("checkpoint 14");
document.addEventListener('DOMContentLoaded', function () 
        {   
            var isResizing = false;
            var lastY;
            var lastX;
            var mouseDown=false;
            var resizableBarBorder = document.getElementById('barResizeID');
            var resizableBar = document.getElementById('barID');
            var contextMenuElement = document.getElementById('contextMenuID');
            resizableBarBorder.addEventListener('mousedown', function (e) 
            {
                e.stopPropagation();
                isResizing = true;
                lastY = e.clientY;
                /* lastX = e.clientX; */
            });
            ////////////////////////////////////////
            resizableBarBorder.addEventListener('mousemove', function (e) {console.log(e.srcElement.style.cursor);});
            ////////////////////////////////////////
            function activateContextMenu(e){
                contextMenuElement.style.display="block";
                contextMenuElement.style.left=e.clientX+"px";
                contextMenuElement.style.top=e.clientY+"px";
            }
            ////////////////////////////////////////
            console.log("checkpoint 15 content loaded");
            document.addEventListener('mousemove', function (e) 
            {
                if (isResizing) 
                {
                    var deltaY = e.clientY - lastY;
                    var contentHeight = resizableBar.offsetHeight;
                    resizableBarBorder.style.height = (contentHeight - deltaY)+5 + 'px';
                    resizableBar.style.height = (contentHeight - deltaY) + 'px';
                    lastY = e.clientY;
                 /*    var deltaX = e.clientX - lastX;
                    var contentWidth = resizableBar.offsetWidth;
                    resizableBarBorder.style.width = (contentWidth  - deltaX)+5 + 'px';
                    resizableBar.style.width = (contentWidth - deltaX) + 'px';
                    lastX = e.clientX; */
                }
            });
            ////////////////////////////////////////
            document.addEventListener('mouseup', function () 
            {
                isResizing = false;
                mouseDown=false;
                console.log("mouseup");
            });
        });
        console.log("checkpoint 16");
//////////////////////////////////////// Open file function
        function openItem(filePath){
   /*  filePath= filePath.replace("/", "\\"); */
    if(filePath.includes("shell:")){
        const { exec } = require('child_process');
        exec('start '+filePath+'', (error, stdout, stderr) => {
        if (error) {
            console.error(`Error opening: ${error.message}`);
            return;
        }
        if (stderr) {
            console.error(`Standard error: ${stderr}`);
            return;
        }
        console.log('Opened successfully');
        });
    }
    console.log(filePath);
    nw.Shell.openItem(filePath);
}
console.log("checkpoint 17");
//////////////////////////////////////// Control center functions
var controlWindowOn=false;
let controlCenterElement=document.getElementById("controlCenterID");
function openControlCenter(event)
{
    if (controlWindowOn==false)
    {   
        if(event.clientX>200){
        controlCenterElement.style.left=parseInt(event.clientX-150)+"px";
        }
        else {controlCenterElement.style.left=parseInt(event.clientX-50)+"px";}
        controlCenterElement.classList.remove("hide");
        controlWindowOn=true;
    }
    else if (controlWindowOn==true)
    {
        controlCenterElement.classList.add("hide");
        controlWindowOn=false;
    }
}
console.log("checkpoint 18");
//////////////////////////////////////// Calendar functions
var calendarOn=false;
var sideBarWasOn=false;
let calendarElement=document.getElementById("calendarID");
function openCalendar(event)
{
    console.log(event)
    if (calendarOn==false)
    {
        if(window.screen.availWidth-event.clientX>200){calendarElement.style.left=parseInt(event.clientX-150)+"px";}
        else {calendarElement.style.left=parseInt(window.screen.availWidth-330)+"px";}
        calendarOn=true;
        calendarElement.classList.remove("hide");
        if(sideBarOn==true)
        {
            sideBarWasOn=true;
            openSideBar();
        }
    }
    else if (calendarOn==true)
    {   
        if(sideBarWasOn==true)
        {
            openSideBar();
        }
        /* controlWindow.window.close(); */
        calendarOn=false;
        calendarElement.classList.add("hide");
    }
}
//////////////////////////////////////// Sidebar functions
var sideBarOn=false;
let sideBarElement=document.getElementById("sideBarID");
function openSideBar()
{
    if (sideBarOn==false)
    {
        sideBarOn=true;
        sideBarElement.classList.remove("hide");;
    }
    else if (sideBarOn==true)
    {
        /* controlWindow.window.close(); */
        sideBarOn=false;
        sideBarElement.classList.add("hide");
    }
}
console.log("checkpoint 19");
//////////////////////////////////////// Search functions
var searchOverlayOn=false;
let searchOverlayElement=document.getElementById("searchOverlayID");
let searchOverlayInputElement=document.getElementById("searchOverlayInputID");
function openSearch()
{
    if (searchOverlayOn==false)
    {
        searchOverlayOn=true;
        searchOverlayElement.classList.remove("hide");
        searchOverlayInputElement.focus();
    }
    else if (searchOverlayOn==true)
    {
        /* controlWindow.window.close(); */
        searchOverlayOn=false;
        searchOverlayElement.classList.add("hide");
    }
}
console.log("checkpoint 20");
//////////////////////////////////////// Media functions
var mediaCenterOn=false;
let mediaCenterElement=document.getElementById("mediaCenterID");
function openMediaCenter()
{
    if (mediaCenterOn==false)
    {
        mediaCenterOn=true;
        mediaCenterElement.classList.remove("hide");
        setTimeout(function(){
            mediaCenterOn=false;
            mediaCenterElement.classList.add("hide");
        },2000);
    }
    else if (mediaCenterOn==true)
    {
/*             setTimeout(function(){
            mediaCenterOn=false;
            mediaCenterElement.classList.add("hide");
        },4000); */
    }
}
//////////////////////////////////////// darkModeOn not working for some reason.... Get's 3 elements of class darkMode, on each function call
console.log("checkpoint 21");
var darkModeIsOn=true;
function darkModeOn(){
    if (darkModeIsOn){
        var darkModeElements=document.getElementsByClassName('darkMode');    
    for(let i=0;i<darkModeElements.length;i++){
        console.log("Removing element: "+i)
        darkModeElements[i].classList.remove('darkMode');
    }
    darkModeIsOn=false;
    }
    else{

    }
}
//////////////////////////////////////// Settings 
function openSettings()
{
    document.getElementById('settingsContainerId').style.display='flex';
}
//////////////////////////////////////// AppMenu
var appMenuOn=false;
let appMenuElement=document.getElementById('appMenuContainerID');
function openAppMenu()
{
    if (appMenuOn==false)
    {
        appMenuOn=true;
        appMenuElement.classList.remove("hide");
    }
    else if (appMenuOn==true)
    {
        appMenuOn=false;
        appMenuElement.classList.add("hide");
    }
}
console.log("checkpoint 22");
//////////////////////////////////////// Settings for colors
var styleElement=document.getElementsByTagName("style");
var oldStyle=styleElement[0].innerHTML;
function acentColorChange(color){
            styleElement[0].innerHTML=oldStyle;
            var css = '.color{background-color: '+color+'b8'+'}';
            oldStyle=styleElement[0].innerHTML;
            styleElement[0].innerHTML=oldStyle+css;
            console.log(styleElement[0]);
        }
//////////////////////////////////////// File copying testing function, now in seperate file
    /* const fs = require('fs');
    async function copy() 
    {
        const sourceFile = 'copyTest.iso'
        const destFile = 'copyTest_done.iso'
        fs.stat(sourceFile, function(err, stat){
        const filesize = stat.size
        let bytesCopied = 0
        let bufferR=0; 
        const readStream = fs.createReadStream(sourceFile)
        
        readStream.on('data', function(buffer)
        {
            bufferR =bufferR+ buffer.length;
        })

        readStream.on('end', function()
        {
            console.log("done");
            console.timeEnd('copying')
        })

        setInterval(() => 
        {
            let prcentage = ((bufferR/filesize)*100).toFixed(2)
            console.log(prcentage+'%') 
        }
        , 1000);
        readStream.pipe(fs.createWriteStream(destFile));
        });
            };
        copy(); */

//////////////////////////////////////////
////////////////////////////////////////// Global key bindings START
/* document.addEventListener("keydown", (event) => 
        {
            //To add keyboard langugage keyboard shortcut, copy/cut/paste shortcut, edgy sideBar shortcut, 
            //print screen shortcut (create tool for screen capture also : shadow wholescreen like in windows 10 snip/sketh)
            //print screen shortcut double press captures the whole screen
            if(event.code=='AudioVolumeMute'){openMediaCenter();volumeMute()}
            if(event.code=='AudioVolumeUp'){openMediaCenter();volumeUp()}
            if(event.code=='AudioVolumeDown'){openMediaCenter();volumeDown()}
            if(event.code=='Fn+F3'){} 
            if(event.code=='ArrowDown'){}
            console.log(event);
        }); */
   /*Global shortcut key*/
 /* var option = {
  key : "AudioVolumeUp",
  active : function() {
    console.log("Global desktop keyboard shortcut: " + this.key + " active."); 
  },
  failed : function(msg) {
    // :(, fail to register the |key| or couldn't parse the |key|.
    console.log(msg);
  }
};

// Create a shortcut with |option|.
var shortcut = new nw.Shortcut(option);

// Register global desktop shortcut, which can work without focus.
nw.App.registerGlobalHotKey(shortcut);
  /*Global shortcut key END*/ 
  console.log("checkpoint 23");
</script>
<script src="./Sortable.js"></script>
<script>
    ////////////////////////////////////////// Making icons in bar sortable
    new Sortable(barElement, 
    {
    animation: 200,
    ghostClass: 'blue-background-class'
    });
/*   new Sortable(dragableIcons , {
    animation: 200,
    ghostClass: 'blue-background-class'
  }); */
  </script>
  <script src="dom-x11-input-region.js"></script>
<script>
const native = require("./nw-input-region/build/Release/nw_input_region.node");
let ctl;
setTimeout(()=>{native.setPID(process.ppid);
ctl = domRegion.start({
    native: {
      setInputRegion: rects => native.setInputRegion(rects)
    },
    selector: '*', // all elements
    tileSize: 12,
    minIntervalMs: 16,
    pixelRatio: window.devicePixelRatio || 1,
    maxRects: 800
  });

},4000);
    
</script>
<!-- <script src="mouse2.js"></script> -->
</body>
</html>
